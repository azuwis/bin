#!/bin/sh

trans() {
  echo "$1" | sed -e 's/0,/000000000000/' -e 's/0x//g' -e s'/[,{} ]//g' | tr -d "\n"
}

ORIG="
{ 0, 0x0000, 0x0000, 0x0000 },
{ 0, 0xaaaa, 0x0000, 0x0000 },
{ 0, 0x0000, 0xaaaa, 0x0000 },
{ 0, 0xaaaa, 0x5555, 0x0000 },
{ 0, 0x0000, 0x0000, 0xaaaa },
{ 0, 0xaaaa, 0x0000, 0xaaaa },
{ 0, 0x0000, 0xaaaa, 0xaaaa },
{ 0, 0xaaaa, 0xaaaa, 0xaaaa },
{ 0, 0x5555, 0x5555, 0x5555 },
{ 0, 0xffff, 0x5555, 0x5555 },
{ 0, 0x5555, 0xffff, 0x5555 },
{ 0, 0xffff, 0xffff, 0x5555 },
{ 0, 0x5555, 0x5555, 0xffff },
{ 0, 0xffff, 0x5555, 0xffff },
{ 0, 0x5555, 0xffff, 0xffff },
{ 0, 0xffff, 0xffff, 0xffff }
"

# For more color scheme https://github.com/caleb-/evilvte/blob/master/src/macro2.h#L700
REPL="
{ 0, 0x3f3f, 0x3f3f, 0x3f3f },
{ 0, 0x7070, 0x5050, 0x5050 },
{ 0, 0x6060, 0xb4b4, 0x8a8a },
{ 0, 0xdfdf, 0xafaf, 0x8f8f },
{ 0, 0x5050, 0x6060, 0x7070 },
{ 0, 0xdcdc, 0x8c8c, 0xc3c3 },
{ 0, 0x8c8c, 0xd0d0, 0xd3d3 },
{ 0, 0xdcdc, 0xdcdc, 0xcccc },
{ 0, 0x7070, 0x9090, 0x8080 },
{ 0, 0xdcdc, 0xa3a3, 0xa3a3 },
{ 0, 0xc3c3, 0xbfbf, 0x9f9f },
{ 0, 0xf0f0, 0xdfdf, 0xafaf },
{ 0, 0x9494, 0xbfbf, 0xf3f3 },
{ 0, 0xecec, 0x9393, 0xd3d3 },
{ 0, 0x9393, 0xe0e0, 0xe3e3 },
{ 0, 0xffff, 0xffff, 0xffff }
"

ORIG=$(trans "$ORIG")
REPL=$(trans "$REPL")

mkdir -p /var/cache/plxterm

if [ ! -e /var/cache/plxterm/lxterminal ]; then
  cp /usr/bin/lxterminal /var/cache/plxterm/lxterminal
fi

hexdump -ve '1/1 "%.2x"' /var/cache/plxterm/lxterminal | \
sed "s/$ORIG/$REPL/" | \
xxd -r -p > /usr/bin/lxterminal

chmod +x /usr/bin/lxterminal
